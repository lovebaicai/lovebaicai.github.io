<!DOCTYPE html><html lang="zh-Hans"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Centos&Ubuntu安装Docker-17.03.02版本问题及解决 · Messay</title><meta name="description" content="Centos&amp;Ubuntu安装Docker-17.03.02版本问题及解决 - Messay"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://messay.me/atom.xml" title="Messay"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/lovebaicai" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/about" target="_self" class="nav-list-link">ABOUT</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Centos&Ubuntu安装Docker-17.03.02版本问题及解决</h1><div class="post-info">Jun 7, 2018</div><div class="post-content"><h4 id="最近在尝试容器化的项目，使用rancher部署kubernetes，奈何kubernetes1-8只支持特定的版本（1-12-6，1-13-1，17-03-02），此为前提。"><a href="#最近在尝试容器化的项目，使用rancher部署kubernetes，奈何kubernetes1-8只支持特定的版本（1-12-6，1-13-1，17-03-02），此为前提。" class="headerlink" title="最近在尝试容器化的项目，使用rancher部署kubernetes，奈何kubernetes1.8只支持特定的版本（1.12.6，1.13.1，17.03.02），此为前提。"></a>最近在尝试容器化的项目，使用rancher部署kubernetes，奈何kubernetes1.8只支持特定的版本（1.12.6，1.13.1，17.03.02），此为前提。</h4><h4 id="Centos安装部署-此Centos版本为7-："><a href="#Centos安装部署-此Centos版本为7-：" class="headerlink" title="Centos安装部署(此Centos版本为7+)："></a>Centos安装部署(此Centos版本为7+)：</h4><ul>
<li><p>目前docker版本已更新为18.05.0-ce，17.03.02建议手动安装。</p>
</li>
<li><p>手动安装17.03.02，需先安装<strong>docker-ce-selinux-17.03.2.ce</strong>，要不会报error，无法安装。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install -y https://download.docker.com/linux/centos/7/x86_64/stable/Packages/docker-ce-selinux-17.03.2.ce-1.el7.centos.noarch.rpm</span><br></pre></td></tr></table></figure>
</li>
<li><p>安装完成后可安装17.03.02。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install -y https://download.docker.com/linux/centos/7/x86_64/stable/Packages/docker-ce-17.03.0.ce-1.el7.centos.x86_64.rpm</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>你也可以直接使用国内yum安装(推荐)</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install -y yum-utils</span><br><span class="line">sudo yum-config-manager \</span><br><span class="line">--add-repo \</span><br><span class="line">https://download.daocloud.io/docker/linux/centos/docker-ce.repo</span><br><span class="line">sudo yum install -y -q --setopt=obsoletes=0 docker-ce-17.03.2.ce* docker-ce-selinux-17.03.2.ce*</span><br><span class="line">sudo systemctl enable docker</span><br><span class="line">sudo systemctl start docker</span><br><span class="line">sudo service docker status</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="Ubuntu安装部署"><a href="#Ubuntu安装部署" class="headerlink" title="Ubuntu安装部署"></a>Ubuntu安装部署</h4><ul>
<li>直接使用国内源安装<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install -y \</span><br><span class="line">apt-transport-https \</span><br><span class="line">ca-certificates \</span><br><span class="line">curl \</span><br><span class="line">software-properties-common</span><br><span class="line">curl -fsSL https://download.daocloud.io/docker/linux/ubuntu/gpg | sudo apt-key add -</span><br><span class="line">sudo add-apt-repository \</span><br><span class="line">&quot;deb [arch=$(dpkg --print-architecture)] https://download.daocloud.io/docker/linux/ubuntu \</span><br><span class="line">$(lsb_release -cs) \</span><br><span class="line">stable&quot;</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install -y -q docker-ce=17.03.2*</span><br><span class="line">sudo service docker start</span><br><span class="line">sudo service docker status</span><br></pre></td></tr></table></figure>
</li>
</ul>
<a id="more"></a>
<h4 id="服务检查"><a href="#服务检查" class="headerlink" title="服务检查"></a>服务检查</h4><ul>
<li><p>检查docker是否安装成功</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudo groupadd docker #建立docker组</span><br><span class="line">sudo usermod -aG docker $USER # 加入docker组</span><br><span class="line"># 退出当前终端并重新登录，进行如下测试</span><br><span class="line">docker version</span><br><span class="line">docker info</span><br><span class="line">docker run hello-world</span><br></pre></td></tr></table></figure>
</li>
<li><p>手动安装需要增加开机自启</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl enable docker</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="镜像加速"><a href="#镜像加速" class="headerlink" title="镜像加速"></a>镜像加速</h4><ul>
<li>国内大家都懂的原因，添加阿里云的镜像加速器。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo mkdir -p /etc/docker</span><br><span class="line">sudo tee /etc/docker/daemon.json &lt;&lt;-&apos;EOF&apos;</span><br><span class="line">&#123;</span><br><span class="line">&quot;registry-mirrors&quot;: [&quot;https://yourself.mirror.aliyuncs.com&quot;]</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line">sudo systemctl daemon-reload</span><br><span class="line">sudo systemctl restart docker</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><strong>一点怨念：国内大多数博客教程（互相抄？）都是让你添加docker的官方源来安装17.03.02，也不知道是到底有没有测试。目前的网络环境来说，docker官方源是很难连上的，当然你走代理另说。善用google，禁用百度。</strong></p>
<h4 id="参考："><a href="#参考：" class="headerlink" title="参考："></a>参考：</h4><ul>
<li><a href="https://blog.csdn.net/CSDN_duomaomao/article/details/79019764" target="_blank" rel="noopener">https://blog.csdn.net/CSDN_duomaomao/article/details/79019764</a></li>
<li><a href="http://www.showerlee.com/archives/2200" target="_blank" rel="noopener">http://www.showerlee.com/archives/2200</a></li>
<li><a href="http://jasmine-abbs.com/docker-daemon/" target="_blank" rel="noopener">http://jasmine-abbs.com/docker-daemon/</a></li>
<li><a href="http://guide.daocloud.io/dce/docker-10592690.html" target="_blank" rel="noopener">安装 Docker</a></li>
</ul>
</div></article></div></main><footer><div class="paginator"><a href="/2018/06/13/kubernetes介绍/" class="prev">PREV</a><a href="/2018/05/30/终端-git设置代理联网/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2021 <a href="http://messay.me">Messay</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>