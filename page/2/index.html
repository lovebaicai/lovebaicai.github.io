<!DOCTYPE html><html lang="zh-Hans"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Messay</title><meta name="description" content="坚实而沉重的活着。"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://messay.me/atom.xml" title="Messay"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/lovebaicai" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/about" target="_self" class="nav-list-link">ABOUT</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><ul class="home post-list"><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2018/07/04/ubuntu-dns显示为127-0-0-1的处理办法/" class="post-title-link">ubuntu dns显示为127.0.0.1的处理办法</a></h2><div class="post-info">Jul 4, 2018</div><div class="post-content"><h4 id="新装一台Ubuntu虚拟机测试dhcp服务器，发现ubuntu的dns显示为：127-0-0-1。有点疑惑，google之，找到原因。"><a href="#新装一台Ubuntu虚拟机测试dhcp服务器，发现ubuntu的dns显示为：127-0-0-1。有点疑惑，google之，找到原因。" class="headerlink" title="新装一台Ubuntu虚拟机测试dhcp服务器，发现ubuntu的dns显示为：127.0.0.1。有点疑惑，google之，找到原因。"></a>新装一台Ubuntu虚拟机测试dhcp服务器，发现ubuntu的dns显示为：127.0.0.1。有点疑惑，google之，找到原因。</h4><ul>
<li><p>ubuntu下有一个本地的dns服务叫做dnsmasq，它是由NetworkManager控制的</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -ef | grep dnsmasq</span><br></pre></td></tr></table></figure>
</li>
<li><p>执行上面命令，你就可以看到它监听的本地地址，<strong>–listen-address=127.0.1.1</strong> (ubuntu12.04及之前的版本 是 127.0.0.1)， 这个地址是一个本地回环地址，而你真实的dns服务器地址，是被这个服务管理维护着的，管理方式如下：</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">local process -&gt; local dnsmasq -&gt; router -&gt; ISP dns</span><br></pre></td></tr></table></figure>
</li>
<li><p>若需要看到真实的DNS地址，可以这么做：</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">sudo vi /etc/NetworkManager/NetworkManager.conf</span><br><span class="line">[main]</span><br><span class="line">plugins=ifupdown,keyfile,ofono</span><br><span class="line">#dns=dnsmasq // 注释此行</span><br><span class="line"></span><br><span class="line">sudo service network-manager restart</span><br><span class="line"></span><br><span class="line">nslookup baidu.com</span><br><span class="line">Server:         192.168.20.21</span><br><span class="line">Address:        192.168.20.21#53</span><br><span class="line"></span><br><span class="line">Non-authoritative answer:</span><br><span class="line">Name:   baidu.com</span><br><span class="line">Address: 220.181.57.216</span><br><span class="line">Name:   baidu.com</span><br><span class="line">Address: 123.125.115.110</span><br></pre></td></tr></table></figure>
</li>
</ul></div><a href="/2018/07/04/ubuntu-dns显示为127-0-0-1的处理办法/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2018/06/26/Kubernetes强制删除一直处于Terminating状态的pod，namespace/" class="post-title-link">Kubernetes强制删除一直处于Terminating状态的pod，namespace</a></h2><div class="post-info">Jun 26, 2018</div><div class="post-content"><h4 id="手动搭建的Kubernetes，使用原生的Dashboard，感觉不舒服，于是使用Rancher2-0代理了Kubernetes的管理web页面。因未知原因，Rancher服务无法启用，删除Rancher依赖的namespace（cattle-system），状态一直是Terminating。此为背景。"><a href="#手动搭建的Kubernetes，使用原生的Dashboard，感觉不舒服，于是使用Rancher2-0代理了Kubernetes的管理web页面。因未知原因，Rancher服务无法启用，删除Rancher依赖的namespace（cattle-system），状态一直是Terminating。此为背景。" class="headerlink" title="手动搭建的Kubernetes，使用原生的Dashboard，感觉不舒服，于是使用Rancher2.0代理了Kubernetes的管理web页面。因未知原因，Rancher服务无法启用，删除Rancher依赖的namespace（cattle-system），状态一直是Terminating。此为背景。"></a>手动搭建的Kubernetes，使用原生的Dashboard，感觉不舒服，于是使用Rancher2.0代理了Kubernetes的管理web页面。因未知原因，Rancher服务无法启用，删除Rancher依赖的namespace（cattle-system），状态一直是Terminating。此为背景。</h4><h4 id="解决方法："><a href="#解决方法：" class="headerlink" title="解决方法："></a>解决方法：</h4><ol>
<li>可使用kubectl中的强制删除命令<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 删除POD</span><br><span class="line">kubectl delete pod PODNAME --force --grace-period=0</span><br><span class="line"></span><br><span class="line"># 删除NAMESPACE</span><br><span class="line">kubectl delete namespace NAMESPACENAME --force --grace-period=0</span><br></pre></td></tr></table></figure>
</li>
</ol></div><a href="/2018/06/26/Kubernetes强制删除一直处于Terminating状态的pod，namespace/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2018/06/13/kubernetes介绍/" class="post-title-link">kubernetes介绍</a></h2><div class="post-info">Jun 13, 2018</div><div class="post-content"><h4 id="初步介绍"><a href="#初步介绍" class="headerlink" title="初步介绍:"></a>初步介绍:</h4><ul>
<li>Kubernetes是Google开源的容器集群管理系统，其提供应用部署、维护、 扩展机制等功能，利用Kubernetes能方便地管理跨机器运行容器化的应用，其主要功能如下：<ol>
<li>使用Docker对应用程序包装(package)、实例化(instantiate)、运行(run)。</li>
<li>以集群的方式运行、管理跨机器的容器。</li>
<li>解决Docker跨机器容器之间的通讯问题。</li>
<li>Kubernetes的自我修复机制使得容器集群总是运行在用户期望的状态。</li>
</ol>
</li>
</ul>
<h4 id="Kubernetes主要概念"><a href="#Kubernetes主要概念" class="headerlink" title="Kubernetes主要概念:"></a>Kubernetes主要概念:</h4><ol>
<li>Node：是kubernetes集群的工作负载节点。Master为其分配工作，当某个Node宕机时，Master会将其工作负载自动转移到其他节点。</li>
<li>Pods：Pod是Kubernetes的基本操作单元，把相关的一个或多个容器构成一个Pod，通常Pod里的容器运行相同的应用。Pod包含的容器运行在同一个Minion(Host)上，看作一个统一管理单元，共享相同的volumes和network namespace/IP和Port空间。Kubernetes为每个Pod都分配了唯一的IP地址，称之为PodIP，一个Pod里的多个容器共享PodIP地址。</li>
<li>Services：Services也是Kubernetes的基本操作单元，是真实应用服务的抽象，每一个服务后面都有很多对应的容器来支持，通过Proxy的port和服务selector决定服务请求传递给后端提供服务的容器，对外表现为一个单一访问接口，外部不需要了解后端如何运行，这给扩展或维护后端带来很大的好处。</li>
<li>Replication Controllers(副本控制器)：Replication Controller确保任何时候Kubernetes集群中有指定数量的pod副本(replicas)在运行， 如果少于指定数量的pod副本(replicas)，Replication Controller会启动新的Container，反之会杀死多余的以保证数量不变。Replication Controller使用预先定义的pod模板创建pods，一旦创建成功，pod 模板和创建的pods没有任何关联，可以修改pod模板而不会对已创建pods有任何影响，也可以直接更新通过Replication Controller创建的pods。对于利用pod模板创建的pods，Replication Controller根据label selector来关联，通过修改pods的label可以删除对应的pods。</li>
<li>Namespace: 命名空间为Kubernetes集群提供虚拟的隔离作用，Kubernetes集群初始有两个命名空间，分别是默认命名空间default和系统命名空间kube-system，除此以外，管理员可以可以创建新的命名空间满足需要。</li>
<li>Volume：Kubernetes的存储卷的生命周期和作用范围是一个Pod。每个Pod中声明的存储卷由Pod中的所有容器共享。Kubernetes支持非常多的存储卷类型，特别的，支持多种公有云平台的存储，包括AWS，Google和Azure云；支持多种分布式存储包括GlusterFS和Ceph；也支持较容易使用的主机本地目录hostPath和NFS。</li>
</ol></div><a href="/2018/06/13/kubernetes介绍/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2018/06/07/Centos-Ubuntu安装Docker-17-03-02版本问题及解决/" class="post-title-link">Centos&Ubuntu安装Docker-17.03.02版本问题及解决</a></h2><div class="post-info">Jun 7, 2018</div><div class="post-content"><h4 id="最近在尝试容器化的项目，使用rancher部署kubernetes，奈何kubernetes1-8只支持特定的版本（1-12-6，1-13-1，17-03-02），此为前提。"><a href="#最近在尝试容器化的项目，使用rancher部署kubernetes，奈何kubernetes1-8只支持特定的版本（1-12-6，1-13-1，17-03-02），此为前提。" class="headerlink" title="最近在尝试容器化的项目，使用rancher部署kubernetes，奈何kubernetes1.8只支持特定的版本（1.12.6，1.13.1，17.03.02），此为前提。"></a>最近在尝试容器化的项目，使用rancher部署kubernetes，奈何kubernetes1.8只支持特定的版本（1.12.6，1.13.1，17.03.02），此为前提。</h4><h4 id="Centos安装部署-此Centos版本为7-："><a href="#Centos安装部署-此Centos版本为7-：" class="headerlink" title="Centos安装部署(此Centos版本为7+)："></a>Centos安装部署(此Centos版本为7+)：</h4><ul>
<li><p>目前docker版本已更新为18.05.0-ce，17.03.02建议手动安装。</p>
</li>
<li><p>手动安装17.03.02，需先安装<strong>docker-ce-selinux-17.03.2.ce</strong>，要不会报error，无法安装。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install -y https://download.docker.com/linux/centos/7/x86_64/stable/Packages/docker-ce-selinux-17.03.2.ce-1.el7.centos.noarch.rpm</span><br></pre></td></tr></table></figure>
</li>
<li><p>安装完成后可安装17.03.02。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install -y https://download.docker.com/linux/centos/7/x86_64/stable/Packages/docker-ce-17.03.0.ce-1.el7.centos.x86_64.rpm</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>你也可以直接使用国内yum安装(推荐)</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install -y yum-utils</span><br><span class="line">sudo yum-config-manager \</span><br><span class="line">--add-repo \</span><br><span class="line">https://download.daocloud.io/docker/linux/centos/docker-ce.repo</span><br><span class="line">sudo yum install -y -q --setopt=obsoletes=0 docker-ce-17.03.2.ce* docker-ce-selinux-17.03.2.ce*</span><br><span class="line">sudo systemctl enable docker</span><br><span class="line">sudo systemctl start docker</span><br><span class="line">sudo service docker status</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="Ubuntu安装部署"><a href="#Ubuntu安装部署" class="headerlink" title="Ubuntu安装部署"></a>Ubuntu安装部署</h4><ul>
<li>直接使用国内源安装<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install -y \</span><br><span class="line">apt-transport-https \</span><br><span class="line">ca-certificates \</span><br><span class="line">curl \</span><br><span class="line">software-properties-common</span><br><span class="line">curl -fsSL https://download.daocloud.io/docker/linux/ubuntu/gpg | sudo apt-key add -</span><br><span class="line">sudo add-apt-repository \</span><br><span class="line">&quot;deb [arch=$(dpkg --print-architecture)] https://download.daocloud.io/docker/linux/ubuntu \</span><br><span class="line">$(lsb_release -cs) \</span><br><span class="line">stable&quot;</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install -y -q docker-ce=17.03.2*</span><br><span class="line">sudo service docker start</span><br><span class="line">sudo service docker status</span><br></pre></td></tr></table></figure>
</li>
</ul></div><a href="/2018/06/07/Centos-Ubuntu安装Docker-17-03-02版本问题及解决/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2018/05/30/终端-git设置代理联网/" class="post-title-link">终端+git设置代理联网</a></h2><div class="post-info">May 30, 2018</div><div class="post-content"><h4 id="天朝的网络环境对技术人员实在是不友好，还好ShadowsocksX-NG已支持sock5，http两种代理协议。"><a href="#天朝的网络环境对技术人员实在是不友好，还好ShadowsocksX-NG已支持sock5，http两种代理协议。" class="headerlink" title="天朝的网络环境对技术人员实在是不友好，还好ShadowsocksX-NG已支持sock5，http两种代理协议。"></a>天朝的网络环境对技术人员实在是不友好，还好ShadowsocksX-NG已支持sock5，http两种代理协议。</h4><h4 id="设置终端代理"><a href="#设置终端代理" class="headerlink" title="设置终端代理"></a>设置终端代理</h4><ul>
<li>在 .bashrc 或 .zshrc 中设置如下内容<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#sock代理</span><br><span class="line">alias setproxy=&quot;export ALL_PROXY=socks5://127.0.0.1:1080&quot;</span><br><span class="line">alias unsetproxy=&quot;unset ALL_PROXY&quot;</span><br><span class="line"></span><br><span class="line">#http代理</span><br><span class="line">alias setproxy=&quot;export ALL_PROXY=http://127.0.0.1:8035&quot;</span><br><span class="line">alias unsetproxy=&quot;unset ALL_PROXY&quot;</span><br><span class="line"></span><br><span class="line">#测试</span><br><span class="line">curl ip.cn</span><br></pre></td></tr></table></figure>
</li>
</ul></div><a href="/2018/05/30/终端-git设置代理联网/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2018/05/20/linux-NFS挂载失败两种异常处理/" class="post-title-link">linux NFS挂载失败两种异常处理</a></h2><div class="post-info">May 20, 2018</div><div class="post-content"><h4 id="最近在研究kubernetes，测试使用NFS作为k8s的文件系统。部署过程中的问题，归纳一下。"><a href="#最近在研究kubernetes，测试使用NFS作为k8s的文件系统。部署过程中的问题，归纳一下。" class="headerlink" title="最近在研究kubernetes，测试使用NFS作为k8s的文件系统。部署过程中的问题，归纳一下。"></a>最近在研究kubernetes，测试使用NFS作为k8s的文件系统。部署过程中的问题，归纳一下。</h4><ul>
<li>报错‘clnt_create: RPC: Program not registered’，解决如下：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># 请按顺序执行</span><br><span class="line">systemctl stop rpcbind</span><br><span class="line">systemctl stop nfs</span><br><span class="line">systemctl start rpcbind</span><br><span class="line">systemctl start nfs</span><br><span class="line">systemctl status rpcbind &amp;&amp; systemctl status nfs</span><br><span class="line"></span><br><span class="line">#测试</span><br><span class="line">mount -t nfs 192.168.7.13:/datadir /mnt</span><br></pre></td></tr></table></figure>
</li>
</ul></div><a href="/2018/05/20/linux-NFS挂载失败两种异常处理/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2018/03/08/cassandra建表异常处理/" class="post-title-link">cassandra建表异常处理</a></h2><div class="post-info">Mar 8, 2018</div><div class="post-content"><h5 id="今天需要在cassandra建立一个新表用作英文spu匹配，报错如下："><a href="#今天需要在cassandra建立一个新表用作英文spu匹配，报错如下：" class="headerlink" title="今天需要在cassandra建立一个新表用作英文spu匹配，报错如下："></a>今天需要在cassandra建立一个新表用作英文spu匹配，报错如下：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Warning: schema version mismatch detected, which might be caused by DOWN nodes; </span><br><span class="line">if this is not the case, check the schema versions of your nodes in system.local and system.peers. </span><br><span class="line">OperationTimedOut: errors=&#123;&#125;, last_host=host</span><br></pre></td></tr></table></figure>
<h5 id="初步判断应该是cassandra节点数据异常，使用nodetool工具修复之，再次建表无异常。"><a href="#初步判断应该是cassandra节点数据异常，使用nodetool工具修复之，再次建表无异常。" class="headerlink" title="初步判断应该是cassandra节点数据异常，使用nodetool工具修复之，再次建表无异常。"></a>初步判断应该是cassandra节点数据异常，使用nodetool工具修复之，再次建表无异常。</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./nodetool repair</span><br></pre></td></tr></table></figure>
<div class="tip">cassandra还是建议定时repair，防止出现数据异常.</div></div><a href="/2018/03/08/cassandra建表异常处理/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2018/03/02/使用百度翻译API翻译数据示例/" class="post-title-link">使用百度翻译API翻译数据示例</a></h2><div class="post-info">Mar 2, 2018</div><div class="post-content"><h5 id="公司使用电商分析平台需要英文版，商品spu数据需要翻译。调研几个平台的翻译API：有道，google，百度，最后选择百度（并不是因为百度翻译的好，而是百度不要钱！）"><a href="#公司使用电商分析平台需要英文版，商品spu数据需要翻译。调研几个平台的翻译API：有道，google，百度，最后选择百度（并不是因为百度翻译的好，而是百度不要钱！）" class="headerlink" title="公司使用电商分析平台需要英文版，商品spu数据需要翻译。调研几个平台的翻译API：有道，google，百度，最后选择百度（并不是因为百度翻译的好，而是百度不要钱！）"></a>公司使用电商分析平台需要英文版，商品spu数据需要翻译。调研几个平台的翻译API：有道，google，百度，最后选择百度（并不是因为百度翻译的好，而是百度不要钱！）</h5><h5 id="示例代码如下："><a href="#示例代码如下：" class="headerlink" title="示例代码如下："></a>示例代码如下：</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> httplib</span><br><span class="line"><span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">appid = <span class="string">''</span> </span><br><span class="line">secretKey = <span class="string">''</span></span><br><span class="line">httpClient = <span class="literal">None</span></span><br><span class="line">fromLang = <span class="string">'zh'</span></span><br><span class="line">toLang = <span class="string">'en'</span></span><br><span class="line"></span><br><span class="line">infos = [] <span class="comment"># 待翻译</span></span><br><span class="line">results = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">make_file</span><span class="params">(filename)</span>:</span></span><br><span class="line">    num = <span class="number">0</span></span><br><span class="line">    <span class="keyword">with</span> open(filename, <span class="string">'w+'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">for</span> info <span class="keyword">in</span> infos:</span><br><span class="line">            myurl = <span class="string">'/api/trans/vip/translate'</span></span><br><span class="line">            q = info.strip()</span><br><span class="line">            salt = random.randint(<span class="number">32768</span>, <span class="number">65536</span>)</span><br><span class="line">            sign = appid+q+str(salt)+secretKey</span><br><span class="line">            m1 = md5.new()</span><br><span class="line">            m1.update(sign)</span><br><span class="line">            sign = m1.hexdigest()</span><br><span class="line">            myurl = myurl+<span class="string">'?appid='</span>+appid+<span class="string">'&amp;q='</span>+urllib.quote(q)+<span class="string">'&amp;from='</span>+fromLang+<span class="string">'&amp;to='</span>+toLang+<span class="string">'&amp;salt='</span>+str(salt)+<span class="string">'&amp;sign='</span>+sign</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                httpClient = httplib.HTTPConnection(<span class="string">'api.fanyi.baidu.com'</span>)</span><br><span class="line">                httpClient.request(<span class="string">'GET'</span>, myurl)</span><br><span class="line">                response = httpClient.getresponse()</span><br><span class="line">                result = json.loads(response.read())[<span class="string">'trans_result'</span>][<span class="number">0</span>][<span class="string">'dst'</span>].encode(<span class="string">'utf-8'</span>)</span><br><span class="line">                results[<span class="string">"data"</span>] = result</span><br><span class="line">                line = json.dumps(results)</span><br><span class="line">                f.write(line + <span class="string">'\n'</span>)</span><br><span class="line">                num += <span class="number">1</span></span><br><span class="line">                <span class="keyword">if</span> num % <span class="number">1000</span> == <span class="number">0</span>:</span><br><span class="line">                    print(<span class="string">'success &#123;&#125;'</span>.format(num))</span><br><span class="line">            <span class="keyword">except</span> Exception, e:</span><br><span class="line">                <span class="keyword">print</span> e</span><br><span class="line">            <span class="keyword">finally</span>:</span><br><span class="line">                <span class="keyword">if</span> httpClient:</span><br><span class="line">                    httpClient.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    filename = <span class="string">'trans.json'</span></span><br><span class="line">    make_file(filename)</span><br></pre></td></tr></table></figure></div><a href="/2018/03/02/使用百度翻译API翻译数据示例/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2018/02/25/二分查找和常用排序Python实现/" class="post-title-link">二分查找和常用排序Python实现</a></h2><div class="post-info">Feb 25, 2018</div><div class="post-content"><h5 id="明白查找和排序基本原理，但是一直手写不出来。手打一遍，帮助记忆。"><a href="#明白查找和排序基本原理，但是一直手写不出来。手打一遍，帮助记忆。" class="headerlink" title="明白查找和排序基本原理，但是一直手写不出来。手打一遍，帮助记忆。"></a>明白查找和排序基本原理，但是一直手写不出来。手打一遍，帮助记忆。</h5><ul>
<li>二分查找：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># author: nemo_chen</span></span><br><span class="line"><span class="comment"># 二分查找Python实现</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">binary_search</span><span class="params">(arr, key)</span>:</span></span><br><span class="line">    start = arr[<span class="number">0</span>]</span><br><span class="line">    end = arr[<span class="number">-1</span>]</span><br><span class="line">    <span class="keyword">while</span> start &lt;= end:</span><br><span class="line">        mid = start + (end - start) / <span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> arr[mid] &gt; key:</span><br><span class="line">            start = mid <span class="number">-1</span></span><br><span class="line">        <span class="keyword">elif</span> arr[mid] &lt; key:</span><br><span class="line">            start = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> mid</span><br></pre></td></tr></table></figure></div><a href="/2018/02/25/二分查找和常用排序Python实现/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2018/02/06/牛顿迭代法计算平方根-Golang-Python实现/" class="post-title-link">牛顿迭代法计算平方根(Golang,Python实现)</a></h2><div class="post-info">Feb 6, 2018</div><div class="post-content"><h4 id="题目："><a href="#题目：" class="headerlink" title="题目："></a>题目：</h4><ul>
<li>牛顿法是通过选择一个初始点 z 然后重复这一过程求 Sqrt(x) 的近似值：<br><img src="http://7xnh53.com1.z0.glb.clouddn.com/niudun.png" alt>
　　</li>
<li><p>为了做到这个，只需要重复计算 10 次，并且观察不同的值（1，2，3，……）是如何逐步逼近结果的。 然后，修改循环条件，使得当值停止改变（或改变非常小）的时候退出循环。</p>
</li>
<li><p>牛顿迭代法的原理很简单，其实是根据f(x)在x0附近的值和斜率，估计f(x)和x轴的交点，看此动态图：<br><img src="http://7xnh53.com1.z0.glb.clouddn.com/Q2Uk_sHeyQSe6VIOp7PnB7PRNYlLd-bHonnaQ2If6O4sAQAA1gAAAEdJ.gif" alt></p>
</li>
<li><p>提示：定义并初始化一个浮点值，向其提供一个浮点语法或使用转换：</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">z := float64(1)</span><br><span class="line">z := 1.0</span><br></pre></td></tr></table></figure></div><a href="/2018/02/06/牛顿迭代法计算平方根-Golang-Python实现/" class="read-more">...more</a></article></li></ul></main><footer><div class="paginator"><a href="/" class="prev">PREV</a><a href="/page/3/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2020 <a href="http://messay.me">Messay</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>